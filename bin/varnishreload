#!/bin/bash
# Reload a varnish config

FILE=${1:-"/etc/varnish/default.vcl"}

NOW=`date +%s`

error()
{
    echo 1>&2 "Failed to reload $FILE."
    exit 1
}

varnishadm vcl.load reload$NOW $FILE || error
varnishadm vcl.use reload$NOW || error
echo Current configs:
varnishadm vcl.list
