#!/bin/zsh
###
# Arch config backup script
# - Dumps installed packages list into ./packages
# - Uses AUR/etckeeper to backup important files from /etc into ./etc.tar.gz
# - Backs up systemd units & services files from /usr/lib/systemd into ./systemd.tar.gz
#
# To automate backups, run the script from a crontab:
# 00 00 * * * (cd ~/Dropbox/arch/laptop; /usr/local/bin/archbackup)
###


# backup explicitly installed package list
yaourt -Qe > packages

# use etckeeper to backup important files in /etc
rm etc.tar.gz
sudo etckeeper init
sudo etckeeper commit -m "Initial" > /dev/null
sudo etckeeper vcs archive --format=tar.gz master > etc.tar.gz
sudo etckeeper uninit -f

# vim:ft=zsh
